project(dcdr-webui)

set(COPIED_DCDR_FLATBUFFERS_JS_FILE ${PROJECT_SOURCE_DIR}/DcdrFlatBuffers.js)
set(COPIED_FLATBUFFERS_JS_FILE ${PROJECT_SOURCE_DIR}/flatbuffers.js)

set(FLATBUFFERS_JS_FILE ${FlatBuffers_SOURCE_DIR}/js/flatbuffers.js)
get_target_property(GENERATED_DCDR_FLATBUFFERS_JS_FILE dcdr-interconnect-flatbuffers GENERATED_JS_FILE)

file(TO_NATIVE_PATH ${COPIED_DCDR_FLATBUFFERS_JS_FILE} COPIED_DCDR_FLATBUFFERS_JS_FILE)
file(TO_NATIVE_PATH ${COPIED_FLATBUFFERS_JS_FILE} COPIED_FLATBUFFERS_JS_FILE)
file(TO_NATIVE_PATH ${GENERATED_DCDR_FLATBUFFERS_JS_FILE} GENERATED_DCDR_FLATBUFFERS_JS_FILE)
file(TO_NATIVE_PATH ${FLATBUFFERS_JS_FILE} FLATBUFFERS_JS_FILE)

if(WIN32)
	set(COPY_COMMAND copy)
else()
	set(COPY_COMMAND cp)
endif()

add_custom_command(
        OUTPUT ${COPIED_DCDR_FLATBUFFERS_JS_FILE} ${COPIED_FLATBUFFERS_JS_FILE}
        COMMAND ${COPY_COMMAND} ${GENERATED_DCDR_FLATBUFFERS_JS_FILE} ${COPIED_DCDR_FLATBUFFERS_JS_FILE}
        COMMAND ${COPY_COMMAND} ${FLATBUFFERS_JS_FILE} ${COPIED_FLATBUFFERS_JS_FILE}
)

add_custom_target(${PROJECT_NAME} ALL DEPENDS
        dcdr-interconnect-flatbuffers
        ${COPIED_DCDR_FLATBUFFERS_JS_FILE}
        ${COPIED_FLATBUFFERS_JS_FILE})